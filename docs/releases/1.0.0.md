# Release 1.0.0 - Google OAuth Authentication & Ticker Filtering

**Release Date**: 2025-11-03
**Tag**: `1.0.0`
**Commit**: `35d2f68`

---

## üéâ Major Features

### Google OAuth Authentication
- **Complete authentication overhaul**: Migrated from `streamlit-authenticator` to Streamlit's built-in Google OAuth via `st.user` API
- **Simplified codebase**: Reduced `auth_utils.py` from ~120 lines to 40 lines
- **Multi-environment support**: Works seamlessly on both localhost and Streamlit Cloud
- **Automated setup**: Created `scripts/setup_oauth.sh` to streamline OAuth client configuration
- **Comprehensive documentation**: Added `docs/GOOGLE_OAUTH_SETUP.md` with step-by-step setup guide

**Authentication Flow**:
- Users log in with Google account
- No password management required
- User info displayed in sidebar (name, email, logout button)
- All 7 pages protected with authentication

### Ticker Filtering for Actionable Stocks
- **Focus on the 5%**: Added UI to filter and focus on stocks with ticker symbols (individual stocks vs mutual funds/ETFs)
- **Statistics dashboard**: Shows breakdown of actionable vs non-actionable disclosures
- **Home page metrics**: Displays ticker percentage and actionable stock counts
- **Trading Signals enhancement**: Shows disclosure analysis during signal generation

**Data Breakdown** (as of release):
- Total disclosures: 1,000
- Actionable stocks (with tickers): ~50 (5%)
- Unique tickers available: 348
- Non-actionable (mutual funds, bonds, etc): ~950 (95%)

---

## üêõ Bug Fixes

### QuiverQuant Scraper Data Corruption
- **Issue**: Scraper was misidentifying table columns, resulting in malformed data like "FIGFIGMA INC CLASS AOT" appearing as ticker
- **Root cause**: Heuristic field detection logic was not properly distinguishing between company names, tickers, and politician names
- **Fix**:
  - Enhanced field detection to identify company name patterns (Inc, Corp, Ltd, LLC)
  - Added separate `asset_name` extraction
  - Fixed `parse_quiver_trade()` to use correct field mapping
- **Cleanup**: Created `scripts/cleanup_corrupt_quiverquant_data.py` and removed 5 corrupt records

### Logger Deprecation Warnings
- **Issue**: Code was using deprecated `logger.warn()` instead of `logger.warning()`
- **Fix**: Updated all calls to use `logger.error()` for exception handling contexts

### Page Title Display
- **Issue**: Sidebar showing "üè† Home" instead of proper page title
- **Fix**: Removed emoji from `page_title` in `st.set_page_config()`, keeping emoji only in `page_icon`

---

## üì¶ Dependencies

### Added
- `Authlib>=1.3.2` - Required for Streamlit's Google OAuth functionality

### Removed
- `streamlit-authenticator` - Replaced with built-in Streamlit OAuth

### Updated
- `uv.lock` - Added Authlib to dependency lock file for Streamlit Cloud deployment

---

## üìÑ New Files & Scripts

### Documentation
- `docs/GOOGLE_OAUTH_SETUP.md` - Complete OAuth setup guide
- `docs/MISSING_TICKERS.md` - Explains ticker behavior for mutual funds vs stocks
- `docs/releases/1.0.0.md` - This release document

### Scripts
- `scripts/setup_oauth.sh` - Automated OAuth client setup with browser automation
- `scripts/cleanup_corrupt_quiverquant_data.py` - Data cleanup utility
- `scripts/check_ticker_data.py` - Data quality checker
- `scripts/debug_disclosure_query.py` - Debugging tool for disclosure queries

### Configuration
- `.streamlit/secrets.toml.oauth` - Template for OAuth secrets configuration
- `.streamlit/secrets.toml` - Local OAuth config (gitignored)
- `.streamlit/secrets.toml.cloud` - Streamlit Cloud OAuth config (gitignored)

---

## üîí Security

### Secrets Management
- OAuth credentials stored in `.streamlit/secrets.toml` (local) and Streamlit Cloud secrets (production)
- Added `.streamlit/secrets.toml*` to `.gitignore` to prevent accidental commits
- GitHub push protection verified working (blocks commits with exposed secrets)

### OAuth Configuration
- **Client ID**: `293495132387-vnt9dv1u1la8jgb4oaelfpncnj2scf7k.apps.googleusercontent.com`
- **Project**: `directed-optics-477110-j0`
- **Redirect URIs**:
  - Local: `http://localhost:8501/oauth2callback`
  - Production: `https://politician-trading-tracker.streamlit.app/oauth2callback`
- **Cookie Secret**: Auto-generated 32-byte secure token

---

## üìä Database Changes

### Data Quality
- Removed 5 corrupt QuiverQuant records
- All remaining 1,000 disclosures validated
- 348 unique tickers available for signal generation

### No Schema Changes
- No database schema modifications in this release
- Existing tables unchanged: `politicians`, `trading_disclosures`, `trading_signals`, `trading_orders`

---

## üöÄ Deployment

### Streamlit Cloud
- ‚úÖ OAuth working on production
- ‚úÖ Authlib dependency resolved via `uv.lock`
- ‚úÖ Secrets configured in Streamlit Cloud dashboard
- ‚úÖ Automatic redeployment on push to `main`

### Local Development
- Run `scripts/setup_oauth.sh` to configure OAuth
- Secrets stored in `.streamlit/secrets.toml`
- Start with: `streamlit run app.py`

---

## üìù Commits (since last deployment)

- Remove emoji from page title for better sidebar display (35d2f68)
- Add Authlib to uv dependencies for Streamlit Cloud OAuth support (2160496)
- Add Authlib dependency for Streamlit OAuth and protect secrets (2c57098)
- Add automated OAuth setup script with Streamlit Cloud support (0a7ab9f)
- Migrate to Google OAuth authentication (#10) (07ab32e)
- Fix QuiverQuant scraper data parsing bug (#9) (154eced)
- Add ticker filtering and focus on actionable stocks (#8) (783ad65)
- Fix deprecation warnings and logger import issue (76d5ae4)
- Add Streamlit Cloud authentication setup guide (4fcb4c1)
- Add authentication to all pages and fix auth error (a593dbb)

---

## üîó Related Issues

- #10 - Migrate to Google OAuth authentication
- #9 - Fix QuiverQuant scraper data parsing bug
- #8 - Add ticker filtering and focus on actionable stocks

---

## ‚ö†Ô∏è Breaking Changes

### Authentication Migration
Users who previously had username/password credentials will need to:
1. Log in with their Google account instead
2. No migration path for old credentials (fresh start)
3. All pages now require Google authentication

### Code Changes
If you've imported from `auth_utils.py`:
- `require_authentication()` - Signature unchanged, now uses `st.user` API
- `show_user_info()` - Signature unchanged, displays Google user info in sidebar
- Removed: `login_user()`, `logout_user()`, `hash_password()`, `verify_credentials()`

---

## üìà What's Next

### Planned for 1.1.0
- Fix timezone bug in `generate_signals.py`
- Generate trading signals from 348 available tickers
- Enhance signal generation with better error handling
- Add signal backtesting features

### Future Enhancements
- Multi-factor authentication options
- Role-based access control (RBAC)
- Admin dashboard for user management
- Enhanced ticker coverage (scrape more sources)

---

## üôè Acknowledgments

- Streamlit team for built-in OAuth support
- Authlib maintainers for OAuth library
- Supabase for database infrastructure
- Google Cloud for OAuth provider
